## 什么是区块链

区块链，就是一个又一个区块组成的链条。每一个区块中保存了一定的信息，它们按照各自产生的时间顺序和一定规则通过 hash 连接成链条。这个链条被保存在所有的服务器中，只要整个系统中有一台服务器可以工作，整条区块链就是安全的。这些服务器在区块链系统中被称为全节点，它们为整个区块链系统提供存储空间和算力支持。如果要修改区块链中的信息，必须征得半数以上节点的同意并修改所有节点中的信息，而这些节点通常掌握在不同的主体手中，因此篡改区块链中的信息是一件极其困难的事。

基于 P2P（点对点）网络的原理，公有链技术本质上是去中心化的，这是其吸引广大公众的关键特性之一。在大多数网络中，公有链没有专用服务器，不是一个授权机构，而是用户之间的共识。

每个区块可以理解成关系型数据库的一张表，但是这张表的数据只能新增和查询，不能删除和修改，每张表之间通过一个计算出来的 hash 值互相连接形成一条链。

相比于传统的网络，区块链具有两大核心特点：一是数据难以篡改、二是去中心化。基于这两个特点，区块链所记录的信息更加真实可靠，可以帮助解决人们互不信任的问题。

### 类型

- 公有区块链：世界上任何个体或者团体都可以发送交易，且交易能够获得该区块链的有效确认，任何人都可以参与其共识过程。公有区块链是最早的区块链，也是应用最广泛的区块链，各大 bitcoins 系列的虚拟数字货币均基于公有区块链，世界上有且仅有一条该币种对应的区块链
- 行业区块链：由某个群体内部指定多个预选的节点为记账人，每个块的生成由所有的预选节点共同决定（预选节点参与共识过程），其他接入节点可以参与交易，但不过问记账过程（本质上还是托管记账，只是变成分布式记账，预选节点的多少，如何决定每个块的记账者成为该区块链的主要风险点），其他任何人可以通过该区块链开放的 API 进行限定查询
- 私有区块链

### 特征

- 去中心化：区块链技术不依赖额外的第三方管理机构或硬件设施，没有中心管制，除了自成一体的区块链本身，通过分布式核算和存储，各个节点实现了信息自我验证、传递和管理。去中心化是区块链最突出最本质的特征
- 开放性
- 独立性：基于协商一致的规范和协议（类似比特币采用的哈希算法等各种数学算法），整个区块链系统不依赖其他第三方，所有节点能够在系统内自动安全地验证、交换数据，不需要任何人为的干预
- 安全性：只要不能掌控全部数据节点的 51%，就无法肆意操控修改网络数据
- 匿名性：各区块节点的身份信息不需要公开或验证，信息传递可以匿名进行

### 架构模型

![架构](/img/区块链架构.png)

- 数据层：封装了底层数据区块以及相关的数据加密和时间戳等基础数据和基本算法；
- 网络层：包括分布式组网机制，数据传播机制和数据验证机制等；
- 共识层：主要封装网络节点的各类共识算法；
- 激励层：主要包括经济激励的发行机制和分配机制等；
- 合约层：主要封装各类脚本，算法和智能合约，是区块链可编程特性的基础；
- 应用层：区块链的各种应用场景和案例；

### 核心技术

#### 分布式账本

分布式账本指的是交易记账由分布在不同地方的多个节点共同完成，而且每一个节点记录的都是完整账本，因此它们都可以参与监督交易合法性。

与传统的分布式存储的不同是：

- 分布式账本每个节点都存储完整数据，分布式存储则是将数据拆分成多份存储；
- 分布式账本每个节点存储都是独立的，地位等同的，依靠共识机制保证存储一致性，分布式存储一般是通过中心节点向其他备份节点同步数据。

#### 非对称加密

#### 共识机制

共识机制就是所有记账节点之间怎么达成共识，去认定一个记录的有效性。区块链提出了不同的共识机制，适用于不同场景：

- 工作量证明机制：节点通过计算随机哈希散列的数值争夺记账权，求得正确的数值解以生成区块。因为求得正确数值在底层算法的保证下，需要节点运行大量的计算才能得出，这个计算就是工作量，比特币的挖矿就是使用的该机制。
- 权益证明机制：当创造一个新区块时，矿工需要创建一个币权交易，交易会按照比例发送币给矿工。权益证明机制根据每个节点拥有代币的比例和时间，依据算法等比例地降低节点的挖矿难度，从而加快了寻找随机数的速度。这种共识机制可以缩短达成共识所需的时间，但本质上仍然需要网络中的节点进行挖矿运算。
- ...

#### 智能合约

智能合约是基于这些可信的不可篡改的数据，可以自动化的执行一些预先定义好的规则和条款。

以保险为例，如果说每个人的信息（包括医疗信息和风险发生的信息）都是真实可信的，那就很容易的在一些标准化的保险产品中，去进行自动化的理赔。

## 区块链运作方式

### 区块链节点

区块链节点简单理解，每个参与者都是一个节点。

根据不同的特征，节点分为不同的类型。以比特币为例，这里有两种类型的节点：

- 一种是存储副本链的全节点，这种节点通过验证数据来保证区块链上数据的安全性和正确性；
- 另一种节点是轻节点，即每个参与的用户，每一个轻节点需要连接到一个全节点，以便同步网络的当前状态并能参与运行；

#### 区块链节点类型

- 全节点：全节点充当网络中的服务器，他们主要任务是存储区块链副本，维护其他节点之间的共识规则及交易验证。
  - 精简节点：从头下载区块，达到设置的限制便删除最旧的区块，仅保留其区块头信息和链位置。
  - 归档节点：这是大多数人理解的全节点，主要任务是保持共识机制并验证区块，托管整个区块链。
- 矿工节点：可能是全节点或轻节点，他们存在的目的是证明该节点已完成创建区块所需的工作。区块链加密货币的参与者通过使用硬件（CPU，GPU 或 ASIC）来解决问题，每个具体任务的第一个完成者将其结果广播到网络，以便通过全节点进行验证。一旦达成共识就可以将其结果作为区块添加到现有的区块链中。矿工除了获得该区块的交易费用，还会获得一定的货币奖励，这种奖励称为创币。
- 主节点：与全节点相比，主节点本身不能向区块链添加区块，作用是保留交易记录并进行验证。通过运行主节点，不仅可以保护网络安全，还可以分享服务收益。
- 轻节点：也可以定义为“轻钱包”，它依靠全节点提供必要的信息与区块链通信，由于没有存储整个区块链，因此它们只能查询一个区块的当前状态并进行广播交易处理。
- 闪电节点：它是在区块链的外部的用户之间建立连接，以此减低网络负载，缩短传输时间，提高加密货币的可用性。闪电节点的工作方式是在实体之间搭建单独的支付渠道。以百吉饼商店和鲍勃为例：鲍勃和商店创建了一个类似保管箱（多重签名地址）的东西，他们俩都有各自的钥匙。鲍勃存入自己的资金，并用它们支付百吉饼。每笔交易均需双方同意，并且几乎是即时发生的。一旦鲍勃有足够的百吉饼或者没钱了，他或商店就可以关闭连接，获取最新的资产负债表，并将其广播到网络上。
- 权益质押节点，授权节点....

1. 每个交易发生时，都会被记录为一个数据“块”；
2. 每个块都连接到位于它前后的块；
3. 每添加一个块都会加强前一个块的验证，从而增强整条区块链；

## 应用

- 金融： 数字人民币，比特币等虚拟货币；
- 物流：通过区块链可以追溯物品生产和运输过程，并且提高供应链的管理效率；
- 数字版权
- 公益
- 保险
- 司法
